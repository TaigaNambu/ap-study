# 4. データベース

## 4.1 データベース設計

### 1. データモデル
* **概念データモデル:** E-R図（エンティティとリレーションシップ）を用いて対象世界を抽象化して表現したもの。
* **論理データモデル:** 関係モデル（テーブル形式）など、DBMSに合わせて設計したもの。

### 2. 正規化 (Normalization)
データの重複を排除し、矛盾（更新時異状）を防ぐ手順。
* **第1正規形:** 繰り返し項目を排除し、すべての属性を単一値にする。
* **第2正規形:** 主キーの一部に依存する項目（部分関数従属）を別テーブルに分離する。
* **第3正規形:** 主キー以外の項目に依存する項目（推移的関数従属）を別テーブルに分離する。

## 4.2 データベース操作と管理

### 3. SQL (Structured Query Language)
* **SELECT文:** `SELECT 列名 FROM 表名 WHERE 条件`
* **集約関数:** `SUM` (合計), `AVG` (平均), `COUNT` (件数), `MAX`, `MIN`。
* **GROUP BY:** データをグループ化する。`HAVING`でグループに対する条件を指定。
* **結合 (JOIN):** 複数の表をつなぎ合わせる。内部結合 (INNER JOIN) や外部結合 (LEFT OUTER JOIN) がある。

### 4. トランザクション管理
* **ACID特性:**
    * **Atomicity (原子性):** すべて実行されるか、全く実行されないか。
    * **Consistency (一貫性):** 整合性が保たれていること。
    * **Isolation (独立性):** 他の処理の影響を受けないこと。
    * **Durability (耐久性):** 結果が失われないこと。
* **コミットとロールバック:** 確定処理と取消処理。

### 5. 排他制御
* **ロック:** データへの同時アクセスを防ぐ。
    * **共有ロック:** 読み取り専用。他からの読み取りは許可、書き込みは不可。
    * **占有ロック:** 読み書き用。他からのアクセスを一切許可しない。
* **デッドロック:** 2つのトランザクションが互いに相手のロック解除を待ち続け、動かなくなる状態。